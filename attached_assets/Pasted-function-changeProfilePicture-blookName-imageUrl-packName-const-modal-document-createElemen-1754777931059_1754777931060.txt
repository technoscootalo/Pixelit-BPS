function changeProfilePicture(blookName, imageUrl, packName) {
  const modal = document.createElement('div');
  modal.classList.add('modal');
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  `;

  const modalContent = document.createElement('div');
  modalContent.classList.add('modal-content');
  modalContent.style.cssText = `
    background-color: #6f057a;
    box-shadow: inset 0 -0.365vw #61056b, 3px 3px 15px rgba(0, 0, 0, 0.6);
    padding: 20px;
    border-radius: 5px;
    text-align: center;
    width: 300px;
    height: 300px;
  `;

  const message = document.createElement('p');
  message.textContent = `Are you sure you want to change your profile picture to ${blookName}?`;
  message.style.textAlign = 'center';
  modalContent.appendChild(message);

  const blookImageEl = document.createElement('img');
  blookImageEl.src = `${imageUrl}`;
  blookImageEl.alt = blookName || 'Unknown Blook';
  blookImageEl.style.width = '130px';
  blookImageEl.style.height = '130px';
  blookImageEl.style.borderRadius = '5px';
  
  blookImageEl.style.display = 'block';
  blookImageEl.style.marginLeft = 'auto';
  blookImageEl.style.marginRight = 'auto';
  blookImageEl.onerror = function() {
    console.error("Failed to load image:", this.src);
    this.src = 'https://izumiihd.github.io/pixelitcdn/assets/img/blooks/logo.png';
  };
  modalContent.appendChild(blookImageEl);

  
  const breakEl = document.createElement('br');
  modalContent.appendChild(breakEl);  

  const yesButton = document.createElement('button');
  yesButton.textContent = 'Yes';
  yesButton.style.cssText = `
    background-color: green;
    box-shadow: inset 0 -0.365vw #006400, 3px 3px 15px rgba(0, 0, 0, 0.6);
    font-family: 'pixelify sans';
    color: white;
    padding: 10px 20px;
    margin: 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: box-shadow 0.3s ease;
  `;

  yesButton.onmouseover = () => {
    yesButton.style.boxShadow = 'inset 0 -0.5vw #006400, 3px 3px 15px rgba(0, 0, 0, 0.6)';
  };

  yesButton.onmouseout = () => {
    yesButton.style.boxShadow = 'inset 0 -0.365vw #006400, 3px 3px 15px rgba(0, 0, 0, 0.6)';
  };

  const noButton = document.createElement('button');
  noButton.textContent = 'No';
  noButton.style.cssText = `
    background-color: red;
    box-shadow: inset 0 -0.365vw #b30000, 3px 3px 15px rgba(0, 0, 0, 0.6);
    font-family: 'pixelify sans';
    color: white;
    padding: 10px 20px;
    margin: 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: box-shadow 0.3s ease;
  `;

  noButton.onmouseover = () => {
    noButton.style.boxShadow = 'inset 0 -0.5vw #b30000, 3px 3px 15px rgba(0, 0, 0, 0.6)';
  };

  noButton.onmouseout = () => {
    noButton.style.boxShadow = 'inset 0 -0.365vw #b30000, 3px 3px 15px rgba(0, 0, 0, 0.6)';
  };

  modalContent.appendChild(yesButton);
  modalContent.appendChild(noButton);
  modal.appendChild(modalContent);
  document.body.appendChild(modal);

  yesButton.onclick = () => {
    fetchJSON("/changePfp", {
      method: "POST",
      body: JSON.stringify({ name: blookName, parent: packName })
    })
    .then(data => {
      if (data.success) {
        const successModal = document.createElement('div');
        successModal.classList.add('modal');
        successModal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          display: flex;
          justify-content: center;
          align-items: center;
          z-index: 1001;
        `;

        const successModalContent = document.createElement('div');
        successModalContent.classList.add('modal-content');
        successModalContent.style.cssText = `
          background-color: white;
          padding: 20px;
          border-radius: 5px;
          text-align: center;
        `;

        const successMessage = document.createElement('p');
        successMessage.textContent = `Successfully changed your profile picture to ${blookName}!`;
        successModalContent.appendChild(successMessage);

        const okayButton = document.createElement('button');
        okayButton.textContent = 'Okay';
        okayButton.style.cssText = `
          background-color: #4CAF50;
          color: white;
          padding: 10px 20px;
          margin: 10px;
          border: none;
          border-radius: 5px;
          cursor: pointer;
        `;
        successModalContent.appendChild(okayButton);
        successModal.appendChild(successModalContent);
        document.body.appendChild(successModal);

        okayButton.onclick = () => {
          document.body.removeChild(modal);
          if (redirectToDashboard) {
            window.location.href = '/dashboard.html';
          }
        };
      } else {
        alert(data.message || "Failed to change profile picture. Please try again.");
      }
      document.body.removeChild(modal); 
    })
    .catch(error => {
      console.error("Error changing profile picture:", error);
      alert("An error occurred while changing the profile picture. Please try again.");
      document.body.removeChild(modal);
    });
  };

  noButton.onclick = () => {
    document.body.removeChild(modal);
  };
}